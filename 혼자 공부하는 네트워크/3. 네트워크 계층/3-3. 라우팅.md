# 3-3. 라우팅
라우터의 핵심 기능 `패킷이 이동할 최적의 경로를 설정한 뒤 해당 경로로 패킷을 이동시키는 것`을 라우팅이라고 한다. 
**라우팅의 분류**와 라우팅에 사용되는 **라우팅 테이블**에 대해 알아보자.

## 라우터
> 네트워크 계층의 핵심 장비

### 홉
> 라우팅 도중 패킷이 호스트 - 라우터, 라우터 - 라우터 간에 이동하는 하나의 과정

여러 개의 홉을 거쳐서 라우팅이 이루어진다.

<hr>

## 라우팅 테이블
> 특정 수신지까지 도달하기 위한 정보를 명시한 일종의 표

라우터의 핵심은 라우터가 저장하고 관리하는 **라우팅 테이블**이다.

### 라우팅 테이블의 핵심 정보
- **수신지 IP 주소 & 서브넷 마스크**
  - 최종적으로 패킷을 전달할 대상
- **다음 홉(next hop)**
  - 최종 수신지까지 가기 위해 다음으로 거쳐야 할 호스트의 IP 주소나 인터페이스 (게이트웨이)
- **네트워크 인터페이스**
  - 패킷을 내보낼 통로
- **메트릭**
  - 해당 경로로 이동하는 데에 드는 비용

<hr>

## 정적 라우팅과 동적 라우팅

### 정적 라우팅
> 사용자가 수동으로 직접 채워 넣은 라우팅 테이블을 기반으로 라우팅하는 것

### 동적 라우팅
> 자동으로 라우팅 테이블 항목을 만들고, 이를 이용하여 라우팅하는 것

#### 동적 라우팅 프로토콜
> 특정 수신지까지 도달하기 위한 최종 경로를 찾기 위해 라우터끼리 자신의 정보를 교환하는 것

#### AS(Autonomous System)
> 라우터들의 집단 네트워크

<hr>

## 라우팅 프로토콜
> 라우터끼리 자신들의 정보를 교환하며 패킷이 이동할 최적의 경로를 찾기 위한 프로토콜

### IGP(Interior Gateway Protocol)
> AS 내부에서 수행되는 라우팅 프로토콜

#### RIP
> **거리 벡터**를 기반

최종 목적지까지 **홉 수가 가장 적은 경로**를 최적의 경로라고 판단한다.

#### OSPF
> **링크 상태**를 기반

링크 상태 데이터베이스을 통해, **대역폭이 높은 링크**일수록 메트릭이 낮은 경로로 인식한다.
OPSF는 AS를 **에어리어** 단위로 나눈 후, 구분된 에어리어 내에서만 링크 상태를 공유한다.
에어리어와 에어리어의 연결은 **ABR**이라는 라우터가 담당한다.

### EGP(Exterior Gateway Protocol)
> AS 외부에서 수행되는 라우팅 프로토콜

#### BGP
> AS 간의 통신에서 사용되는 대표적인 프로토콜

다른 AS와 통신하기 위해서 다른 AS의 BGP 라우터와 통신해야 하는데, BGP 라우터(피어)끼리 통신하는 과정을 **피어링**이라고 한다.
BUT, BGP는 RIP와 OSPF에 비해 최적의 경로 결정 과정이 복잡하다. 다양한 **속성과 정책**을 고려하기 때문이다.

- 속성
  - AS-PATH
  - NEXT-HOP
  - LOCAL-PREF
- 정책
  - 특정 AS 우대, 보안과 안정성 우선시, 성능 우선시 등등.. AS 관리 주체에 따라 다름